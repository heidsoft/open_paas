!function(t){t.fn.flowList=function(a){function i(i){function h(){o=g.find(">li"),e=o.length,s=g.parent().width(),r=o.eq(0).outerWidth(),n=o.eq(0).outerHeight(),f=Math.floor((s+a.gap)/(r+a.gap)),l=!1,d=[]}function v(){g.css({width:s}),o.last().find(".flow-arrow").remove(),o.removeClass("odd").removeClass("even").removeClass("last");for(var t=0;t<e;t++)t%f==0&&(l=!l),l?d.push([t%f*(r+a.gap),Math.floor(t/f)*(n+a.vGap),"even"]):d.push([(f-1-t%f)*(r+a.gap),Math.floor(t/f)*(n+a.vGap),"odd"]);for(var t=0;t<e;t++)o.eq(t).css({position:"absolute",left:d[t][0],top:d[t][1],margin:0}).attr("even-odd",d[t][2]).addClass(d[t][2]);g.find(".odd").prev(".even").addClass("last"),g.find(".even").prev(".odd").addClass("last")}function c(){var t=g.find(".flow-box").css("border-right-width");o.filter(".last").find(".flow-arrow").removeAttr("style"),o.filter(".last").find(".flow-arrow").css({height:a.vGap,width:a.vGap,"margin-top":t}),o.filter(".even:not(.last)").find(".flow-arrow").css({right:-a.gap-parseInt(t),left:"auto",width:a.gap}),o.filter(".odd:not(.last)").find(".flow-arrow").css({right:"auto",left:-a.gap-parseInt(t),width:a.gap})}function p(){g.css({width:e>f-1?d[f-1][0]+r:d[e-1][0]+r,height:d[e-1][1]+n,visibility:"visible"})}function u(){h(),v(),c(),p()}function w(){var a=-1;g.find(".flow-box").each(function(i,o){t(this).height()>a&&(a=t(this).outerHeight())}),g.find(".flow-box").css("height",a)}var g=i;a.url?t.ajax({url:a.url,type:"GET",dataType:"json",success:function(t){if(!g.attr("finished")){var i=t.data;g.empty();for(var o=0;o<i.length;o++){var e=a.format(i,o);g.append(e)}g.attr("finished",!0)}u(),w()}}):u()}var o,e,s,r,n,f,l,d,h={gap:60,vGap:30,format:function(t,a){return'<li class="flow-box '+t[a].addClass+'"><div class="flow-text" title="'+t[a].title+'">'+t[a].text+'</div><div class="flow-arrow"><div class="'+t[a].arrowClass+'"></div></div></li>'}},a=t.extend({},h,a),v=this;v.each(function(){var a=t(this);i(a)}),t(window).resize(function(a){v.each(function(){var a=t(this);i(a)})})}}(jQuery);